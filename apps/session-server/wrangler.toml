name = "shipyard-session-server"
main = "src/index.ts"
compatibility_date = "2025-01-01"
account_id = "191909c2c1a28f6cb73d12e3362b874c"  # Jacob@schoolai.com's Account

# Durable Object bindings
[[durable_objects.bindings]]
name = "PERSONAL_ROOM"
class_name = "PersonalRoom"

[[durable_objects.bindings]]
name = "COLLAB_ROOM"
class_name = "CollabRoom"

# Migration to create SQLite-backed Durable Objects
[[migrations]]
tag = "v1"
new_sqlite_classes = ["PersonalRoom", "CollabRoom"]

# D1 Database for user identity
[[d1_databases]]
binding = "DB"
database_name = "shipyard-users"
database_id = "placeholder-create-with-wrangler"
migrations_dir = "migrations"

# Development settings
[dev]
port = 4444
local_protocol = "http"

# Environment variables (non-secret)
[vars]
ENVIRONMENT = "production"
LOG_LEVEL = "info"

# Development environment overrides
[env.development.vars]
ENVIRONMENT = "development"
LOG_LEVEL = "debug"

[[env.development.durable_objects.bindings]]
name = "PERSONAL_ROOM"
class_name = "PersonalRoom"

[[env.development.durable_objects.bindings]]
name = "COLLAB_ROOM"
class_name = "CollabRoom"

[[env.development.migrations]]
tag = "v1"
new_sqlite_classes = ["PersonalRoom", "CollabRoom"]

[[env.development.d1_databases]]
binding = "DB"
database_name = "shipyard-users-dev"
database_id = "placeholder-create-with-wrangler"
migrations_dir = "migrations"

# Secrets (set via wrangler secret put):
# - GITHUB_CLIENT_ID
# - GITHUB_CLIENT_SECRET
# - JWT_SECRET
