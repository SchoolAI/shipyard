name = "peer-plan-signaling"
main = "src/index.ts"
compatibility_date = "2025-01-01"
account_id = "191909c2c1a28f6cb73d12e3362b874c"  # Jacob@schoolai.com's Account

# Use Node.js compatibility for Buffer if needed
# node_compat = true

# Durable Object binding - routes to our SignalingRoom class
[[durable_objects.bindings]]
name = "SIGNALING_ROOM"
class_name = "SignalingRoom"

# Migration to create the SQLite-backed Durable Object
# SQLite backend is required for free tier and recommended for paid
[[migrations]]
tag = "v1"
new_sqlite_classes = ["SignalingRoom"]

# Optional: Custom domain for WebSocket connections
# [routes]
# route = "signaling.yourdomain.com/*"

# Development settings
[dev]
port = 4444
local_protocol = "http"

# Environment-specific configuration
[vars]
ENVIRONMENT = "development"

# Production environment overrides
[env.production.vars]
ENVIRONMENT = "production"

# Durable Object binding for production (must be duplicated, not inherited)
[[env.production.durable_objects.bindings]]
name = "SIGNALING_ROOM"
class_name = "SignalingRoom"

[[env.production.migrations]]
tag = "v1"
new_sqlite_classes = ["SignalingRoom"]
